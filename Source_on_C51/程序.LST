C51 COMPILER V7.06   _Ì_ò                                                                  11/04/2012 00:38:08 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE _Ì_ò
OBJECT MODULE PLACED IN ³ÌÐò.OBJ
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE ³ÌÐò.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          /*********************************************************************************
   2          * ¡¾±àÐ´Ê±¼ä¡¿£º 2011.07.07
   3          * ¡¾×÷    Õß¡¿£º Ô´ÂëÀ´×ÔÍøÂç
   4          * ¡¾°æ    ±¾¡¿£º V1.0
   5          * ¡¾Íø    Õ¾¡¿£º www.wlcpu.com 
   6          * ¡¾Q      Q¡¿£º478199347
   7          * ¡¾Éù    Ã÷¡¿£º ´Ë³ÌÐò½öÓÃÓÚÑ§Ï°Óë²Î¿¼£¬ÒýÓÃÇë×¢Ã÷°æÈ¨ºÍ×÷ÕßÐÅÏ¢£¡
   8          * ¡¾º¯Êý¹¦ÄÜ¡¿£º ÊýÂë¹ÜÊµÑé-Êý×ÖÖÓ                                                                                  
   9          * ¡¾Ê¹ÓÃËµÃ÷¡¿£º ×¢ÒâÏÈÓÃÌøÏßÃ°½«J6¶Ì½Ó£¬Ê¹ÓÃ·äÃùÆ÷Ä£¿é
  10                                           °´ÏÂ¶ÀÁ¢°´¼ü1 ÇåÁã
  11                                           °´ÏÂ¶ÀÁ¢°´¼ü2 ·Ö¼Ó1
  12                                           °´ÏÂ¶ÀÁ¢°´¼ü3 ÇåÁã
  13                                           °´ÏÂ¶ÀÁ¢°´¼ü4 ÇåÁã
  14          **********************************************************************************/
  15          
  16          #include <AT89X51.H>
  17          
  18          /* º¯ÊýÉêÃ÷ -----------------------------------------------*/
  19          void sdata(void);
  20          void out(void);
  21          void bcon(void);
  22          void delay (unsigned char h);
  23          
  24          /* ±äÁ¿¶¨Òå -----------------------------------------------*/
  25          unsigned int tcount;
  26          unsigned char m;
  27          static unsigned char second,minute,hour;
  28           
  29          unsigned char code fseg[]={0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90};
  30          unsigned char code segbit[]={0x80,0x40,0x20,0x10,0x08,0x04,0x02,0x01};
  31          unsigned char  disbuf[8]={0,0,0,0,0,0,0,0};
  32          
  33          
  34          sbit MOSIO=P2^2;
  35          sbit R_CLKa=P2^3;
  36          sbit S_CLKa=P2^4;
  37          
  38          sbit key1=P3^2;
  39          sbit key2=P3^3;
  40          sbit key3=P3^4;
  41          sbit key4=P3^5;
  42          
  43          /*
  44          ********************************************************************************
  45          ** º¯ÊýÃû³Æ £º main(void)
  46          ** º¯Êý¹¦ÄÜ £º Ö÷º¯Êý
  47          ********************************************************************************
  48          */
  49          void main(void)
  50           {      
  51   1        TMOD=0x02;
  52   1        TH0=0x06;
  53   1        TL0=0x06;
  54   1        TR0=1;
  55   1        ET0=1;
C51 COMPILER V7.06   _Ì_ò                                                                  11/04/2012 00:38:08 PAGE 2   

  56   1        EA=1;
  57   1      
  58   1        while(1)
  59   1        {
  60   2         bcon();
  61   2         sdata();
  62   2         out();
  63   2      
  64   2        }
  65   1        //while(1);
  66   1      
  67   1       } 
  68          /*
  69          ********************************************************************************
  70          ** º¯ÊýÃû³Æ £º sdata(void)
  71          ** º¯Êý¹¦ÄÜ £º Êý¾Ý´«Êä
  72          ********************************************************************************
  73          */
  74          void sdata(void)
  75           {unsigned char b,c,num;
  76   1      
  77   1              if(b==0)
  78   1              {       
  79   2                b++;
  80   2              num=segbit[m];
  81   2               for(c=0;c<8;c++)
  82   2                      {S_CLKa=0;
  83   3                        MOSIO=num&0x80;
  84   3                        num<<=1;
  85   3                        S_CLKa=1;
  86   3                 }
  87   2              
  88   2              } 
  89   1      
  90   1              if(b==1)
  91   1      
  92   1              {  
  93   2                  b--;
  94   2                if(m==2||m==5)
  95   2                {num=0xbf;}
  96   2                else
  97   2                 {num=fseg[disbuf[m]];}
  98   2      
  99   2                      for(c=0;c<8;c++)
 100   2                        {  S_CLKa=0;
 101   3                               MOSIO=num&0x80;
 102   3                               num<<=1;
 103   3                               S_CLKa=1;
 104   3                        }
 105   2              
 106   2              }
 107   1                   m++;
 108   1                   if(m==8)
 109   1                       {m=0;
 110   2                        }
 111   1       }
 112          
 113          
 114          
 115           /*
 116          ********************************************************************************
 117          ** º¯ÊýÃû³Æ £º delay (unsigned char h)
C51 COMPILER V7.06   _Ì_ò                                                                  11/04/2012 00:38:08 PAGE 3   

 118          ** º¯Êý¹¦ÄÜ £º ÑÓÊ±0.1ms¸öµ¥Î»
 119          ********************************************************************************
 120          */
 121           void delay (unsigned char h)
 122            {     
 123   1              while(h--);
 124   1        }
 125           
 126           /*
 127          ********************************************************************************
 128          ** º¯ÊýÃû³Æ £º out(void)
 129          ** º¯Êý¹¦ÄÜ £º Êý¾ÝÊä³ö
 130          ********************************************************************************
 131          */
 132          void out(void)
 133           { R_CLKa=0;
 134   1        delay(50);
 135   1         R_CLKa=1;
 136   1       } 
 137          
 138          
 139          /*
 140          ********************************************************************************
 141          ** º¯ÊýÃû³Æ £º bcon(void)
 142          ** º¯Êý¹¦ÄÜ £º ¼üÅÌ¿ØÖÆ
 143          ********************************************************************************
 144          */
 145            void bcon(void)
 146            {
 147   1                if(key1==0)
 148   1                {
 149   2                              delay(100);
 150   2                          if(key1==0)
 151   2                          {
 152   3                                 second=0;
 153   3                                 while(key1==0);                
 154   3                              }
 155   2                }
 156   1                disbuf[0]=second%10;
 157   1                disbuf[1]=second/10;
 158   1      
 159   1                if(key2==0)
 160   1            {
 161   2                        delay(100);
 162   2                        if(key2==0)
 163   2                        {
 164   3                              minute++;
 165   3                              while(key2==0);
 166   3                              if(minute==60)
 167   3                              {
 168   4                                      minute=0;
 169   4                              }
 170   3                        }
 171   2                }
 172   1                disbuf[3]=minute%10;
 173   1                disbuf[4]=minute/10;
 174   1      
 175   1      
 176   1                if(key3==0)
 177   1            {
 178   2                      delay(100);
 179   2                  if(key3==0)
C51 COMPILER V7.06   _Ì_ò                                                                  11/04/2012 00:38:08 PAGE 4   

 180   2                  {
 181   3                              hour++;
 182   3                          while(key3==0);
 183   3                              if(hour==24)
 184   3                              {
 185   4                                      hour=0;
 186   4                              }
 187   3                      }
 188   2                }     
 189   1                disbuf[6]=hour%10;
 190   1                disbuf[7]=hour/10;
 191   1      
 192   1                if(key4==0)
 193   1            {
 194   2                      delay(100);
 195   2                  if(key4==0)
 196   2                  {
 197   3                              second = 0;
 198   3                              minute = 0;
 199   3                              hour =0 ;       
 200   3                      }
 201   2                }     
 202   1      
 203   1              
 204   1              disbuf[0]=second%10;
 205   1              disbuf[1]=second/10;
 206   1              disbuf[3]=minute%10;
 207   1              disbuf[4]=minute/10;
 208   1              disbuf[6]=hour%10;
 209   1              disbuf[7]=hour/10;
 210   1      
 211   1         }
 212            
 213          
 214          
 215          /*
 216          ********************************************************************************
 217          ** º¯ÊýÃû³Æ £º t0(void) interrupt 1 using 0
 218          ** º¯Êý¹¦ÄÜ £º ¶¨Ê±Æ÷ÖÐ¶Ï
 219          ********************************************************************************
 220          */
 221          
 222           void t0(void) interrupt 1 using 0 
 223            {     tcount++;
 224   1      
 225   1          if(tcount==4000)
 226   1                {tcount=0;
 227   2                  second++;
 228   2      
 229   2                       if(second==60)
 230   2                        {second=0;
 231   3                         minute++;
 232   3      
 233   3                          if(minute==60)
 234   3                               {minute=0;
 235   4                                hour++;
 236   4      
 237   4                                if(hour==24)
 238   4                                 {hour=0;
 239   5                                 }
 240   4                               }
 241   3                        }
C51 COMPILER V7.06   _Ì_ò                                                                  11/04/2012 00:38:08 PAGE 5   

 242   2                }
 243   1              }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    384    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     14       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
